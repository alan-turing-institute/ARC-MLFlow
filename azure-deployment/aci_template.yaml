apiVersion: '2019-12-01'
type: Microsoft.ContainerInstance/containerGroups
name: mlflow-aci
tags: {}
location: uksouth
properties:
  containers:
  - name: mlflow
    properties:
      image: ghcr.io/alan-turing-institute/arc-mlflow-image
      environmentVariables:
        - name: AZURE_STORAGE_CONNECTION_STRING
          value: <AZURE_STORAGE_CONNECTION_STRING>
        - name: BACKEND_STORE_URI
          value: <BACKEND_STORE_URI>
        - name: ARTIFACT_ROOT
          value: <ARTIFACT_ROOT>
      command:
      - "/root/start_mlflow_server.sh"
      ports:
      - port: 5000
      resources:
        requests:
          cpu: 2.0
          memoryInGB: 4
      volumeMounts:
      - mountPath: /data
        name: mlflowdb
  osType: Linux
  restartPolicy: Always
  ipAddress:
    type: Public
    ports:
      - port: 5000
    dnsNameLabel: mlflow-aci
  volumes:
    - name: mlflowdb
      azureFile:
        sharename: dbfileshare
        storageAccountName: <STORAGE_ACCOUNT_NAME>
        storageAccountKey: <STORAGE_ACCOUNT_KEY>
